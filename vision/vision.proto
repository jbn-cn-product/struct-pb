syntax = "proto3";

package vision;

/* ---------- 数据类型 ---------- */

// 握手消息
message Handshake {
    string id = 1; // "bodycam" "edge"
}
// 人脸检测结果
message FaceResult {
    message Landmarks { // 关键点
        message Point { // 坐标
            float x = 1;
            float y = 2;
        }
        Point point_left_eye = 1;
        Point point_right_eye = 2;
        Point point_nose = 3;
        Point point_left_mouth = 4;
        Point point_right_mouth = 5;
    }
    bytes image = 1;
    float confidence = 2;
    Landmarks landmarks = 3;
}
// 车牌检测结果
message PlateResult {
    bytes image = 1;
    string number = 2;
}
// 录制请求
message RecordRequest {}
// 录制响应
message RecordResponse {
    bytes video = 1;
    bytes image = 2;
}
// 烟包识别结果
message CigarettesResult {
    message Class { // 类别
        string class = 1;
        uint32 x1 = 2;
        uint32 x2 = 3;
        uint32 y1 = 4;
        uint32 y2 = 5;
    }
    repeated Class classes = 1;
    bytes image = 2;
}
// 证件识别结果
message LicenseResult {
    repeated string texts = 1;
    bytes image = 2;
}
// 盒子状态响应
message EdgeStatusResponse {
    int32 temperature = 1;
    float battery = 2;
}
// 盒子状态请求
message EdgeStatusRequest {}
// 识别请求
message DetectRequest {
    int32 type = 1; // 1 - cigarette, 40 - license_biz, 41 - license_cig
    bytes image = 2;
}
// 计划
message Schedule {
    // 经纬度
    message Geo {
        double lat = 1;
        double lng = 2;
    }
    Geo geo = 1;
    string id = 2;
}

/* ---------- 包装消息 ---------- */
message Msg {
    Handshake handshake = 1;
    FaceResult face_result = 2;
    PlateResult plate_result = 3;
    RecordRequest record_request = 4;
    RecordResponse record_response = 5;
    CigarettesResult cigarettes_result = 6;
    LicenseResult license_result = 7;
    EdgeStatusResponse edge_status_response = 8;
    EdgeStatusRequest edge_status_request = 9;
    DetectRequest detect_request = 10;
    Schedule schedule = 11;
}